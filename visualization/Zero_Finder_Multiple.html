<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>ãƒªãƒ¼ãƒãƒ³é›¶ç‚¹æ¢ç´¢ - è¤‡æ•°é›¶ç‚¹å¯¾å¿œ</title>
<style>
body {
    margin: 0;
    padding: 20px;
    background: #000;
    color: #fff;
    font-family: monospace;
}
.container {
    max-width: 1400px;
    margin: 0 auto;
}
h2 { color: #0f0; }
.section {
    background: #111;
    padding: 20px;
    border-radius: 8px;
    margin-bottom: 20px;
}
.preset-group {
    margin-bottom: 20px;
    padding: 15px;
    background: #0a0a0a;
    border-radius: 8px;
}
.preset-group h4 {
    margin-top: 0;
    color: #0ff;
}
.preset-buttons {
    display: flex;
    gap: 10px;
    flex-wrap: wrap;
}
button {
    padding: 12px 20px;
    background: #222;
    color: #0f0;
    border: 1px solid #0f0;
    border-radius: 4px;
    cursor: pointer;
    font-size: 13px;
    font-weight: bold;
}
button:hover { background: #0f0; color: #000; }
button.active { background: #0f0; color: #000; }
.result {
    background: #0a0a0a;
    padding: 15px;
    border-left: 3px solid #0f0;
    margin: 10px 0;
    border-radius: 4px;
}
.warning { border-color: #f80; }
.error { border-color: #f00; }
.success { border-color: #0f0; background: #002200; }
.value { color: #0ff; font-weight: bold; }
table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 10px;
}
th, td {
    padding: 10px;
    text-align: left;
    border-bottom: 1px solid #333;
}
th { background: #0a0a0a; color: #0f0; }
.progress {
    width: 100%;
    height: 30px;
    background: #222;
    border-radius: 4px;
    overflow: hidden;
    margin: 10px 0;
}
.progress-bar {
    height: 100%;
    background: linear-gradient(90deg, #0a0, #0f0);
    transition: width 0.3s;
    display: flex;
    align-items: center;
    justify-content: center;
    color: #000;
    font-weight: bold;
}
.custom-input {
    display: flex;
    gap: 10px;
    align-items: center;
    margin-top: 10px;
}
.custom-input input {
    padding: 8px;
    background: #222;
    border: 1px solid #444;
    color: #fff;
    border-radius: 4px;
    width: 120px;
}
</style>
</head>
<body>

<div class="container">
    <h2>ğŸ¯ ãƒªãƒ¼ãƒãƒ³ã‚¼ãƒ¼ã‚¿é›¶ç‚¹æ¢ç´¢ã‚·ã‚¹ãƒ†ãƒ </h2>
    
    <div class="section">
        <h3>ğŸ“ æ—¢çŸ¥ã®é›¶ç‚¹</h3>
        
        <div class="preset-group">
            <h4>ç¬¬ä¸€é›¶ç‚¹ (t â‰ˆ 14.134725)</h4>
            <div class="preset-buttons">
                <button onclick="searchZero(1, 'coarse')">ç²—æ¢ç´¢ Â±10</button>
                <button onclick="searchZero(1, 'medium')">ä¸­æ¢ç´¢ Â±1</button>
                <button onclick="searchZero(1, 'fine')">ç²¾å¯† Â±0.1</button>
                <button onclick="searchZero(1, 'ultra')">è¶…ç²¾å¯† Â±0.01</button>
            </div>
        </div>
        
        <div class="preset-group">
            <h4>ç¬¬äºŒé›¶ç‚¹ (t â‰ˆ 21.022040) â­ ç™ºè¦‹ï¼</h4>
            <div class="preset-buttons">
                <button onclick="searchZero(2, 'coarse')">ç²—æ¢ç´¢ Â±10</button>
                <button onclick="searchZero(2, 'medium')">ä¸­æ¢ç´¢ Â±1</button>
                <button onclick="searchZero(2, 'fine')">ç²¾å¯† Â±0.1</button>
                <button onclick="searchZero(2, 'ultra')">è¶…ç²¾å¯† Â±0.01</button>
            </div>
        </div>
        
        <div class="preset-group">
            <h4>ç¬¬ä¸‰é›¶ç‚¹ (t â‰ˆ 25.010858)</h4>
            <div class="preset-buttons">
                <button onclick="searchZero(3, 'coarse')">ç²—æ¢ç´¢ Â±10</button>
                <button onclick="searchZero(3, 'medium')">ä¸­æ¢ç´¢ Â±1</button>
                <button onclick="searchZero(3, 'fine')">ç²¾å¯† Â±0.1</button>
                <button onclick="searchZero(3, 'ultra')">è¶…ç²¾å¯† Â±0.01</button>
            </div>
        </div>
        
        <div class="preset-group">
            <h4>ã‚«ã‚¹ã‚¿ãƒ æ¢ç´¢</h4>
            <div class="custom-input">
                <label>tä¸­å¿ƒ:</label>
                <input type="number" id="customT" value="14.134725" step="0.001">
                <label>ç¯„å›²Â±:</label>
                <input type="number" id="customRange" value="0.1" step="0.01">
                <label>åˆ»ã¿:</label>
                <select id="customDt">
                    <option value="0.01">0.01</option>
                    <option value="0.001" selected>0.001</option>
                    <option value="0.0001">0.0001</option>
                    <option value="0.00001">0.00001</option>
                </select>
                <button onclick="searchCustom()">å®Ÿè¡Œ</button>
            </div>
        </div>
        
        <div class="preset-buttons" style="margin-top:20px;">
            <button onclick="scanWalls()" style="border-color:#08f; color:#08f;">ğŸ§± å£ã‚¹ã‚­ãƒ£ãƒ³</button>
            <button onclick="exportResults()" style="border-color:#f80; color:#f80;">ğŸ’¾ JSONå‡ºåŠ›</button>
        </div>
    </div>
    
    <div class="section" id="status">
        <h3>â³ ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</h3>
        <p>é›¶ç‚¹ã‚’é¸æŠã—ã¦æ¢ç´¢ã‚’é–‹å§‹ã—ã¦ãã ã•ã„</p>
    </div>
    
    <div class="section" id="results" style="display:none;">
        <h3>ğŸ“Š çµæœ</h3>
        <div id="resultsContent"></div>
    </div>
</div>

<script>
// æ—¢çŸ¥ã®é›¶ç‚¹ã®è¿‘ä¼¼å€¤
const knownZeros = {
    1: 14.134725142,
    2: 21.022039639,
    3: 25.010857580,
    4: 30.424876126,
    5: 32.935061588
};

// Î¶é–¢æ•°è¨ˆç®—
function zeta(sigma, t, N = 5000) {
    let eta_re = 0, eta_im = 0;
    
    for (let n = 1; n <= N; n++) {
        const sign = (n % 2 === 1) ? 1 : -1;
        const logn = Math.log(n);
        const mag = Math.exp(-sigma * logn);
        const arg = -t * logn;
        eta_re += sign * mag * Math.cos(arg);
        eta_im += sign * mag * Math.sin(arg);
    }
    
    const log2 = Math.log(2);
    const exp_r = Math.exp((1 - sigma) * log2);
    const exp_arg = -t * log2;
    const d_re = 1 - exp_r * Math.cos(exp_arg);
    const d_im = -exp_r * Math.sin(exp_arg);
    const d2 = d_re * d_re + d_im * d_im + 1e-300;
    
    const re = (eta_re * d_re + eta_im * d_im) / d2;
    const im = (eta_im * d_re - eta_re * d_im) / d2;
    
    return { 
        re, 
        im, 
        abs: Math.sqrt(re*re + im*im)
    };
}

let allResults = {};

async function search(sigma, tCenter, tRange, dt, N = 5000) {
    const data = [];
    let minAbs = Infinity;
    let minPoint = null;
    
    const steps = Math.floor((2 * tRange) / dt);
    
    for (let i = 0; i <= steps; i++) {
        const t = tCenter - tRange + i * dt;
        const z = zeta(sigma, t, N);
        
        if (z.abs < minAbs) {
            minAbs = z.abs;
            minPoint = { t, ...z };
        }
        
        if (i % 100 === 0) {
            updateProgress(i, steps);
            await new Promise(resolve => setTimeout(resolve, 0));
        }
    }
    
    return { minPoint, totalPoints: steps + 1 };
}

function updateProgress(current, total) {
    const percent = (current / total * 100).toFixed(1);
    const statusDiv = document.getElementById('status');
    statusDiv.innerHTML = `
        <h3>â³ è¨ˆç®—ä¸­...</h3>
        <div class="progress">
            <div class="progress-bar" style="width:${percent}%">${percent}%</div>
        </div>
        <p>${current.toLocaleString()} / ${total.toLocaleString()} ç‚¹</p>
    `;
}

async function searchZero(zeroNum, precision) {
    const configs = {
        'coarse': { tRange: 10, dt: 0.01, N: 3000, name: 'ç²—æ¢ç´¢' },
        'medium': { tRange: 1, dt: 0.001, N: 5000, name: 'ä¸­æ¢ç´¢' },
        'fine': { tRange: 0.1, dt: 0.0001, N: 8000, name: 'ç²¾å¯†æ¢ç´¢' },
        'ultra': { tRange: 0.01, dt: 0.00001, N: 10000, name: 'è¶…ç²¾å¯†' }
    };
    
    const config = configs[precision];
    const tCenter = knownZeros[zeroNum];
    const sigma = 0.5;
    
    document.getElementById('status').innerHTML = `
        <h3>ğŸ” ç¬¬${zeroNum}é›¶ç‚¹ - ${config.name}</h3>
        <p>Ïƒ = ${sigma}</p>
        <p>tä¸­å¿ƒ = ${tCenter}</p>
        <p>ç¯„å›² = Â±${config.tRange}</p>
        <p>åˆ»ã¿ = ${config.dt}</p>
    `;
    
    const result = await search(sigma, tCenter, config.tRange, config.dt, config.N);
    
    const key = `zero${zeroNum}_${precision}`;
    allResults[key] = {
        zeroNum,
        precision,
        config,
        result: result.minPoint,
        totalPoints: result.totalPoints
    };
    
    displayResult(key, zeroNum, config, result);
}

async function searchCustom() {
    const tCenter = parseFloat(document.getElementById('customT').value);
    const tRange = parseFloat(document.getElementById('customRange').value);
    const dt = parseFloat(document.getElementById('customDt').value);
    
    const config = { tRange, dt, N: 5000, name: 'ã‚«ã‚¹ã‚¿ãƒ æ¢ç´¢' };
    const sigma = 0.5;
    
    const result = await search(sigma, tCenter, tRange, dt, config.N);
    
    allResults['custom_' + Date.now()] = {
        config: { tCenter, ...config },
        result: result.minPoint,
        totalPoints: result.totalPoints
    };
    
    displayResult('custom', 'ã‚«ã‚¹ã‚¿ãƒ ', config, result);
}

function displayResult(key, zeroNum, config, result) {
    document.getElementById('results').style.display = 'block';
    const content = document.getElementById('resultsContent');
    
    const isZero = result.minPoint.abs < 1e-6;
    const isNear = result.minPoint.abs < 1e-3;
    const isClose = result.minPoint.abs < 0.01;
    
    const resultClass = isZero ? 'success' : isNear ? 'warning' : isClose ? 'warning' : 'error';
    
    let html = `
        <div class="result ${resultClass}">
            <h4>${typeof zeroNum === 'number' ? `ç¬¬${zeroNum}é›¶ç‚¹` : zeroNum} - ${config.name}</h4>
            <table>
                <tr><th>é …ç›®</th><th>å€¤</th></tr>
                <tr><td>è¨ˆç®—ç‚¹æ•°</td><td>${result.totalPoints.toLocaleString()}</td></tr>
                <tr><td>tä½ç½®</td><td class="value">${result.minPoint.t.toFixed(12)}</td></tr>
                <tr><td>|Î¶(0.5+it)|</td><td class="value">${result.minPoint.abs.toExponential(10)}</td></tr>
                <tr><td>Re(Î¶)</td><td class="value">${result.minPoint.re.toExponential(10)}</td></tr>
                <tr><td>Im(Î¶)</td><td class="value">${result.minPoint.im.toExponential(10)}</td></tr>
            </table>
    `;
    
    if (isZero) {
        html += `<p style="color:#0f0; font-size:18px; margin-top:10px;">ğŸ¯ é›¶ç‚¹ã‚’ç™ºè¦‹ï¼ |Î¶| < 10â»â¶</p>`;
    } else if (isNear) {
        html += `<p style="color:#f80; margin-top:10px;">âš ï¸ é›¶ç‚¹ã«éå¸¸ã«è¿‘ã„ (|Î¶| < 0.001)ã€‚æ¬¡ã®ç²¾åº¦ã§æ¢ç´¢æ¨å¥¨ã€‚</p>`;
    } else if (isClose) {
        html += `<p style="color:#f80; margin-top:10px;">ğŸ“ é›¶ç‚¹ã«è¿‘ã„ (|Î¶| < 0.01)ã€‚ã‚ˆã‚Šç²¾å¯†ãªæ¢ç´¢ã‚’æ¨å¥¨ã€‚</p>`;
    } else {
        html += `<p style="color:#f00; margin-top:10px;">âŒ ã“ã®ç¯„å›²ã§ã¯é›¶ç‚¹ãŒé ã„ã€‚</p>`;
    }
    
    html += `</div>`;
    
    content.innerHTML = html + content.innerHTML;
    
    document.getElementById('status').innerHTML = `
        <h3>âœ… å®Œäº†</h3>
        <p>æ¬¡ã®ç²¾åº¦ã‚’è©¦ã™ã‹ã€åˆ¥ã®é›¶ç‚¹ã‚’æ¢ç´¢ã—ã¦ãã ã•ã„</p>
    `;
}

async function scanWalls() {
    const sigmas = [0.49, 0.495, 0.499, 0.5, 0.501, 0.505, 0.51];
    const tCenter = 14.134725;
    const tRange = 0.5;
    const dt = 0.001;
    
    const results = [];
    
    for (let i = 0; i < sigmas.length; i++) {
        updateProgress(i, sigmas.length);
        const result = await search(sigmas[i], tCenter, tRange, dt, 5000);
        results.push({
            sigma: sigmas[i],
            min_distance: result.minPoint.abs,
            t_at_min: result.minPoint.t,
            re_at_min: result.minPoint.re,
            im_at_min: result.minPoint.im
        });
        await new Promise(resolve => setTimeout(resolve, 100));
    }
    
    allResults['wall_scan'] = results;
    displayWallResults(results);
}

function displayWallResults(results) {
    document.getElementById('results').style.display = 'block';
    const content = document.getElementById('resultsContent');
    
    let html = `<div class="result"><h4>ğŸ§± å£ã‚¹ã‚­ãƒ£ãƒ³çµæœ</h4><table>
        <tr><th>Ïƒ</th><th>æœ€å°è·é›¢</th><th>è©•ä¾¡</th></tr>`;
    
    for (const r of results) {
        const isWall = r.min_distance > 0.001;
        const status = r.min_distance < 1e-6 ? 'ğŸ¯' : isWall ? 'ğŸ§±' : 'âš ï¸';
        const color = r.min_distance < 1e-6 ? '#0f0' : isWall ? '#f00' : '#f80';
        html += `<tr><td>${r.sigma.toFixed(3)}</td>
                 <td style="color:${color};">${r.min_distance.toExponential(4)}</td>
                 <td>${status}</td></tr>`;
    }
    
    html += `</table></div>`;
    content.innerHTML = html + content.innerHTML;
    
    document.getElementById('status').innerHTML = '<h3>âœ… å£ã‚¹ã‚­ãƒ£ãƒ³å®Œäº†</h3>';
}

function exportResults() {
    if (Object.keys(allResults).length === 0) {
        alert('ã¾ãšæ¢ç´¢ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„');
        return;
    }
    
    const json = JSON.stringify(allResults, null, 2);
    const blob = new Blob([json], { type: 'application/json' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = 'riemann_zeros_' + Date.now() + '.json';
    a.click();
}
</script>

</body>
</html>
